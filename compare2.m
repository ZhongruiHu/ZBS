% Generates figure ZBS-prob2

r = [0.06, 0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.20];

phi = [		% k=1:25 analytical; k=26:56 experimental {{{
0.862168,
0.75613 ,
0.673142,
0.607086,
0.553643,
0.509726,
0.473108,
0.44216 ,
0.41568 ,
0.392767,
0.372737,
0.355069,
0.339355,
0.325277,
0.31258 ,
0.301063,
0.290558,
0.280932,
0.272072,
0.263885,
0.256292,
0.249233,
0.242636,
0.236162,
0.23446 ,	% 25
0.229073,	% 26
0.224124,	% 27
0.219228,	% 28
0.214491,	% 29
0.209858,	% 30
0.206411,	% 31
0.202695,	% 32
0.198517,	% 33
0.194765,	% 34
0.191870,	% 35
0.187840,	% 36
0.184256,	% 37
0.180952,	% 38
0.178613,	% 39
0.175323,	% 40
0.172776,	% 41
0.169925,	% 42
0.167319,	% 43
0.164788,	% 44
0.162461,	% 45
0.160314,	% 46
0.157947,	% 47
0.155790,	% 48
0.153770,	% 49
0.151721,	% 50
0.150070,	% 51
0.148275,	% 52
0.147293,	% 53
0.145117,	% 54
0.142951,	% 55
0.141381,	% 56
0.139896,	% 57
0.137973,	% 58
0.136286,	% 59
0.134698];	% 60}}}

sigma = [	% From a.xls for k=1:50
1.148359, 
1.242248,
1.324327,
1.398556,
1.425776,
1.478505,
1.505301,
1.530002,
1.558995,
1.589913,
1.601284,
1.616834,
1.628119,
1.644447,
1.676979,
1.684638,
1.680960,
1.692744,
1.706022,
1.714721,
1.717019,
1.728896,
1.726633,
1.738283,
1.748649,
1.754724,
1.759417,
1.760129,
1.769109,
1.770747,
1.777578,
1.779811,
1.781214,
1.788005,
1.792862,
1.793909,
1.795261,
1.798126,
1.801044,
1.805415,
1.801571,
1.811608,
1.811077,
1.819349,
1.819215,
1.820560,
1.816817,
1.825232,
1.823967,
1.828635];

n = 300;

% x axis
p = 0;
for i = 1:size(r, 2)
	p(i) = pi*r(i)*r(i);
end

P_V = 0;
P_H = 0;
P_U = 0;
for i = 1:size(r, 2)
	P_V(i) = (1+3*sqrt(3)/(4*pi))*p(i);	
	k = ceil(p(i)*n)-1;
	sigmasq = sigma(k)*sigma(k);
	P_U(i) = 8*(1-sigmasq)*acos(sigma(k)/2) + sigma(k)*(2+sigmasq)*sqrt(4-sigmasq);
	P_U(i) = P_U(i)*p(i)/(4*pi*(4-sigmasq));
	P_H(i) = (phi(k)*P_U(i) - sqrt(3)*p(i)/4/pi)/(phi(k)-1);
end

clf;
hold all;
semilogy(p, P_V, '-x');
semilogy(p, P_H, '-+');
semilogy(p, P_U, '-<');
xlim([0.01, 0.085]);
xlabel('Link probability (p)');
ylabel('Risk probabilities');
legend('P_V(u,v)', 'P_H(u,v,)', 'P_U(u,v)');

% vim:foldmethod=marker:
