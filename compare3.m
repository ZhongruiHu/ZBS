% Generates figure ZBS-prob3
% Raw data from exp7.R

r200 = [0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.20, 0.21];
r250 = [0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.20, 0.21];
r300 = [0.06, 0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.20];
r350 = [0.06, 0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.20];
r400 = [0.05, 0.06, 0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19];
r450 = [0.05, 0.06, 0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19];
r500 = [0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18];
r550 = [0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18];
r600 = [0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17];
r650 = [0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17];
r700 = [0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16];

% R means Raw
P_U200R = [0.001547, 0.001912, 0.002234, 0.002450, 0.002666, 0.002750, 0.002903, 0.002946, 0.003055, 0.003069, 0.003042, 0.003108, 0.003230, 0.003228, 0.003258];
P_U250R = [0.001454, 0.001721, 0.001974, 0.002048, 0.002172, 0.002183, 0.002277, 0.002317, 0.002383, 0.002471, 0.002461, 0.002534, 0.002557, 0.002564, 0.002558];
P_U300R = [0.001155, 0.001373, 0.001564, 0.001747, 0.001838, 0.001911, 0.001917, 0.002004, 0.001985, 0.001981, 0.002013, 0.002021, 0.002085, 0.002148, 0.002152];
P_U350R = [0.001076, 0.001300, 0.001426, 0.001565, 0.001657, 0.001661, 0.001668, 0.001716, 0.001749, 0.001785, 0.001785, 0.001781, 0.001817, 0.001848, 0.001810];
P_U400R = [0.000795, 0.001036, 0.001204, 0.001348, 0.001477, 0.001489, 0.001494, 0.001491, 0.001499, 0.001508, 0.001542, 0.001586, 0.001598, 0.001619, 0.001623];
P_U450R = [0.000756, 0.000973, 0.001163, 0.001253, 0.001349, 0.001384, 0.001361, 0.001314, 0.001355, 0.001382, 0.001422, 0.001447, 0.001445, 0.001434, 0.001487];
P_U500R = [0.000548, 0.000746, 0.000902, 0.001030, 0.001144, 0.001255, 0.001276, 0.001210, 0.001226, 0.001236, 0.001228, 0.001249, 0.001275, 0.001264, 0.001236];
P_U550R = [0.000539, 0.000705, 0.000879, 0.000986, 0.001069, 0.001147, 0.001147, 0.001105, 0.001115, 0.001107, 0.001140, 0.001128, 0.001145, 0.001169, 0.001179];
P_U600R = [0.000335, 0.000518, 0.000702, 0.000830, 0.000911, 0.000970, 0.001043, 0.001010, 0.001030, 0.001025, 0.001032, 0.001027, 0.001029, 0.001057, 0.001051];
P_U650R = [0.000329, 0.000508, 0.000669, 0.000791, 0.000883, 0.000935, 0.000964, 0.000969, 0.000936, 0.000947, 0.000964, 0.000961, 0.000945, 0.000960, 0.000971];
P_U700R = [0.000160, 0.000325, 0.000504, 0.000644, 0.000739, 0.000802, 0.000873, 0.000882, 0.000889, 0.000898, 0.000894, 0.000905, 0.000876, 0.000888, 0.000911];

n_array = [200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700];

% R means Raw
P_U008R = [0.001912, 0.001721, 0.001564, 0.001426, 0.001348, 0.001253, 0.001144, 0.001069, 0.000970, 0.000935, 0.000873];
P_U012R = [0.002750, 0.002183, 0.001917, 0.001668, 0.001491, 0.001314, 0.001226, 0.001115, 0.001025, 0.000947, 0.000894];
P_U016R = [0.003069, 0.002471, 0.002013, 0.001785, 0.001586, 0.001447, 0.001275, 0.001145, 0.001057, 0.000960, 0.000911];

sigma = [	% From a.xls for k=1:60
1.148359264, 
1.24224756 ,
1.324327376,
1.398556399,
1.42577628 ,
1.478504988,
1.505300634,
1.530001634,
1.558994868,
1.589912891,
1.60128386 ,
1.616833943,
1.628118546,
1.644446715,
1.676978831,
1.68463824 ,
1.680960142,
1.692743631,
1.706021981,
1.714721552,
1.717018928,
1.728896469,
1.72663314 ,
1.738282773,
1.748649193,
1.75472391 ,
1.759416949,
1.760128688,
1.769109098,
1.770747582,
1.777577846,
1.779811226,
1.781213631,
1.788004754,
1.792861958,
1.793909139,
1.795260705,
1.798126247,
1.801043864,
1.805415465,
1.801571259,
1.811608401,
1.811076752,
1.819349059,
1.819215215,
1.820560353,
1.816816722,
1.825232314,
1.823967379,
1.82863501 ,
1.82863501 ,
1.827867063,
1.833320212,
1.832966721,
1.838617687,
1.839045133,
1.843507798,
1.843903197,
1.843646929,
1.848080355];

clf;
hold all;

% constants
a1 = -0.000124; a2 = 0.1304; b = 1.5356; c = 0.1745;

% n = 200, 400, 600
n = 200; P_U200 = 0; P_U200F = 0;
for i = 1:size(r200, 2)
	p = pi*r200(i)*r200(i);
	k = ceil(p*n)-1;
	sigmasq = sigma(k)*sigma(k);
	P_U200(i) = 8*(1-sigmasq)*acos(sigma(k)/2) + sigma(k)*(2+sigmasq)*sqrt(4-sigmasq);
	P_U200(i) = P_U200(i)*p/(4*pi*(4-sigmasq));	
end
for i = 1:size(r200, 2)
	lambda = (a1*n+a2)/(r200(i)^3) + b*n + c;
	tmp = (3*sqrt(3)-4*pi)*r200(i)*r200(i)*lambda;
	P_U200F(i) = (1+(1/6)*exp(tmp/6)*(-6+tmp))/lambda;
end

n = 400; P_U400 = 0; P_U400T = 0;
for i = 1:size(r400, 2)
	p = pi*r400(i)*r400(i);
	k = ceil(p*n)-1;
	sigmasq = sigma(k)*sigma(k);
	P_U400(i) = 8*(1-sigmasq)*acos(sigma(k)/2) + sigma(k)*(2+sigmasq)*sqrt(4-sigmasq);
	P_U400(i) = P_U400(i)*p/(4*pi*(4-sigmasq));	
end
for i = 1:size(r400, 2)
	lambda = (a1*n+a2)/(r400(i)^3) + b*n + c;
	tmp = (3*sqrt(3)-4*pi)*r400(i)*r400(i)*lambda;
	P_U400F(i) = (1+(1/6)*exp(tmp/6)*(-6+tmp))/lambda;
end

n = 600; P_U600 = 0; P_U600F = 0;
for i = 1:size(r600, 2)
	p = pi*r600(i)*r600(i);
	k = ceil(p*n)-1;
	sigmasq = sigma(k)*sigma(k);
	P_U600(i) = 8*(1-sigmasq)*acos(sigma(k)/2) + sigma(k)*(2+sigmasq)*sqrt(4-sigmasq);
	P_U600(i) = P_U600(i)*p/(4*pi*(4-sigmasq));	
end
for i = 1:size(r600, 2)
	lambda = (a1*n+a2)/(r600(i)^3) + b*n + c;
	tmp = (3*sqrt(3)-4*pi)*r600(i)*r600(i)*lambda;
	P_U600F(i) = (1+(1/6)*exp(tmp/6)*(-6+tmp))/lambda;
end

subplot(2,2,1);
plot(r200, P_U200,  'ko-', ...
	 r200, P_U200R, 'kx--', ...
	 r400, P_U400,  'b+-', ...
	 r400, P_U400R, 'b*--', ...	 
	 r600, P_U600,  'rs-', ...
	 r600, P_U600R, 'rd--');
title('(a)')
xlabel('Radio range (r)');
ylabel('P_U(u,v)');
legend('200 nodes (estimated)', '200 nodes (simulated)', ...
	   '400 nodes (estimated)', '400 nodes (simulated)', ...
	   '600 nodes (estimated)', '600 nodes (simulated)');

subplot(2,2,3);
plot(r200, P_U200F, 'ko-', ...
	 r200, P_U200R, 'kx--', ...
	 r400, P_U400F, 'b+-', ...
	 r400, P_U400R, 'b*--', ...	 
	 r600, P_U600F, 'rs-', ...
	 r600, P_U600R, 'rd--');
title('(c)')
xlabel('Radio range (r)');
ylabel('P_U(u,v)');
legend('200 nodes (estimated)', '200 nodes (simulated)', ...
	   '400 nodes (estimated)', '400 nodes (simulated)', ...
	   '600 nodes (estimated)', '600 nodes (simulated)');	   

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% r = 0.08, 0.12, 0.16
r = 0.08; P_U008 = 0; PU008F = 0;
for i = 1:size(n_array, 2)
	p = pi*r*r;
	k = ceil(p*n_array(i))-1;
	sigmasq = sigma(k)*sigma(k);
	P_U008(i) = 8*(1-sigmasq)*acos(sigma(k)/2) + sigma(k)*(2+sigmasq)*sqrt(4-sigmasq);
	P_U008(i) = P_U008(i)*p/(4*pi*(4-sigmasq));
end
for i = 1:size(n_array, 2)
	lambda = (a1*n_array(i)+a2)/(r^3) + b*n_array(i) + c;
	tmp = (3*sqrt(3)-4*pi)*r*r*lambda;
	P_U008F(i) = (1+(1/6)*exp(tmp/6)*(-6+tmp))/lambda;
end

r = 0.12; P_U012 = 0; P_U012F = 0;
for i = 1:size(n_array, 2)
	p = pi*r*r;
	k = ceil(p*n_array(i))-1;
	sigmasq = sigma(k)*sigma(k);
	P_U012(i) = 8*(1-sigmasq)*acos(sigma(k)/2) + sigma(k)*(2+sigmasq)*sqrt(4-sigmasq);
	P_U012(i) = P_U012(i)*p/(4*pi*(4-sigmasq));	
end
for i = 1:size(n_array, 2)
	lambda = (a1*n_array(i)+a2)/(r^3) + b*n_array(i) + c;
	tmp = (3*sqrt(3)-4*pi)*r*r*lambda;
	P_U012F(i) = (1+(1/6)*exp(tmp/6)*(-6+tmp))/lambda;
end

r = 0.16; P_U016 = 0;
for i = 1:size(n_array, 2)
	p = pi*r*r;
	k = ceil(p*n_array(i))-1;
	sigmasq = sigma(k)*sigma(k);
	P_U016(i) = 8*(1-sigmasq)*acos(sigma(k)/2) + sigma(k)*(2+sigmasq)*sqrt(4-sigmasq);
	P_U016(i) = P_U016(i)*p/(4*pi*(4-sigmasq));	
end
for i = 1:size(n_array, 2)
	lambda = (a1*n_array(i)+a2)/(r^3) + b*n_array(i) + c;
	tmp = (3*sqrt(3)-4*pi)*r*r*lambda;
	P_U016F(i) = (1+(1/6)*exp(tmp/6)*(-6+tmp))/lambda;
end

subplot(2,2,2);
plot(n_array, P_U008,  'ko-', ...
	 n_array, P_U008R, 'kx--', ...
	 n_array, P_U012,  'b+-', ...
	 n_array, P_U012R, 'b*--', ...
	 n_array, P_U016,  'rs-', ...
	 n_array, P_U016R, 'rd--');
title('(b)')	 
xlabel('Total number of nodes');
ylabel('P_U(u,v)');
legend('r=0.08 (estimated)', 'r=0.08 (simulated)', ...
	   'r=0.12 (estimated)', 'r=0.12 (simulated)', ...
	   'r=0.16 (estimated)', 'r=0.16 (simulated)');

subplot(2,2,4);
plot(n_array, P_U008F, 'ko-', ...
	 n_array, P_U008R, 'kx--', ...
	 n_array, P_U012F, 'b+-', ...
	 n_array, P_U012R, 'b*--', ...
	 n_array, P_U016F, 'rs-', ...
	 n_array, P_U016R, 'rd--');
title('(d)')	 
xlabel('Total number of nodes');
ylabel('P_U(u,v)');
legend('r=0.08 (estimated)', 'r=0.08 (simulated)', ...
	   'r=0.12 (estimated)', 'r=0.12 (simulated)', ...
	   'r=0.16 (estimated)', 'r=0.16 (simulated)');	   
